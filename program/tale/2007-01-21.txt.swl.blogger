<?xml version='1.0' encoding='UTF-8'?>
<ns0:entry xmlns:ns0="http://www.w3.org/2005/Atom"><ns0:id>tag:blogger.com,1999:blog-3618780804544792727.post-2043318528778425878</ns0:id><ns0:author><ns0:name>Kris Kowal</ns0:name><ns0:email>cowbertvonmoo@gmail.com</ns0:email><ns0:uri>http://www.blogger.com/profile/01443956999129365941</ns0:uri></ns0:author><ns0:content type="html">
&lt;p&gt;So, the sorting rules for the sprite graphic (which includes such lovely permutations as the Pachyrat, Bunnysaur, and Llamacorn (do you &lt;i&gt;ever&lt;/i&gt; get tired of writing L's?  I think not)) were getting unwieldy and as a result were largely incorrect.  However, I was having some trouble convincing my topo sort algorithm to report cycles, and even then it would have been problematic to figure out where they needed to be broken.  What does this mean?  Vaguely, it means that my rules would occasionally say that the bunny ears were in front of the bunny rider, and occasionally the bunny ears would be behind the bunny rider.  Of course it would be much more complicated.  Here's an example cycle: the bunny ears are behind the mount head which is behind the llama fur, which is behind the saddle, which is behind the dinosaur head, which is behind the bunny ears.  Since the rules file uses a lot of regular expressions and sandwiching techniques, these cycles are hard to find.  I needed a way to visualize the problem.&lt;/p&gt;
&lt;p&gt;Enter Graphviz.   Graphviz is a tool that takes data describing a graph and produces an image of the graph.  A picture is worth a thousand words.  I spruced up the Cixar Python library's graphkit module (which uses Graphviz) and wrote a tool that produces graphs of layer sorting rules files.  This is &lt;a href="http://cixar.comhttp://cixar.com/~kris.kowal/bdoc/program/tale/2007-01-21/rules.old.png"&gt;what I beheld&lt;/a&gt;.  (&lt;a href="http://cixar.comhttp://cixar.com/~kris.kowal/bdoc/program/tale/2007-01-21/rules.old.txt"&gt;old rules&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;So, there are a few cycles in there.  Ok, maybe a lot.  They're easiest to spot by looking for arrows pointing up instead of down.  Ooops.  Clearly this isn't manageable.  So, I started rewriting the layer sorting rules one set of layers at a time.  I added a feature that lets me make "virtual layers" like "rider_face_bottom" and "rider_face_top" so I could organize the layers into boxes and sandwich the boxes.  This is &lt;a href="http://cixar.comhttp://cixar.com/~kris.kowal/bdoc/program/tale/2007-01-21/rules.new.png"&gt;the result&lt;/a&gt;.  In addition, the layer rules are all correct now, and I will be able to show off some demo graphics that include the mount rider tomorrow.  (&lt;a href="http://cixar.comhttp://cixar.com/~kris.kowal/bdoc/program/tale/2007-01-21/rules.new.txt"&gt;new rules&lt;/a&gt;)&lt;/p&gt;
</ns0:content><ns0:updated>2008-09-30T13:56:05.051-07:00</ns0:updated><ns0:published>2007-01-21T21:01:00.001-08:00</ns0:published><ns0:title type="text">Visualizing Sorting Rules</ns0:title><ns0:link href="http://askawizard.blogspot.com/feeds/2043318528778425878/comments/default" rel="replies" title="Post Comments" type="application/atom+xml" /><ns0:link href="http://www.blogger.com/comment.g?blogID=3618780804544792727&amp;postID=2043318528778425878" rel="replies" title="0 Comments" type="text/html" /><ns0:link href="http://www.blogger.com/feeds/3618780804544792727/posts/default/2043318528778425878" rel="edit" type="application/atom+xml" /><ns0:link href="http://www.blogger.com/feeds/3618780804544792727/posts/default/2043318528778425878" rel="self" type="application/atom+xml" /><ns0:link href="http://askawizard.blogspot.com/2007/01/visualizing-sorting-rules_21.html" rel="alternate" title="Visualizing Sorting Rules" type="text/html" /></ns0:entry>